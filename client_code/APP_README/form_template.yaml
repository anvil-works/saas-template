components: []
container:
  properties:
    html: |-
      <style>
      li, ol, ul {
        padding-top: 5px;
        padding-bottom: 5px;
      }
      figure {
        position: relative;
        margin-bottom: 3rem;
      }
      figure img {
          display: block;
      }

      figcaption {
        position: absolute;
        bottom: -2rem;
        left: 0;
        right: 0;
      }
      </style>
      <div style="margin:2% 3%; font-size:20px;">
        <h1>Getting Started</h1>
        <p>
          Welcome to Anvil’s SaaS template! This README will guide you through getting started with the template, understanding its features, and further developing it to suit your needs.
        </p>
        <p>
          If you're looking to sell a product as an online service, this template is a perfect starting point. In this guide, we’ll walk through building a simple calculator as a sample product.
        </p>
        <p>
          To make the most of the README's hyperlinks, simply click on 'Run in new tab' in the editor's top-right corner and follow the instructions below.
        </p>
        <br>
        <img src="https://anvil-website-static.s3.eu-west-2.amazonaws.com/misc-assets/run-in-new-tab.svg" height="150px"/>
        <br>
        <br>
        <p>If you prefer to access this information outside of the Anvil editor, you can also find a <a href="https://anvil.works/learn/tutorials/using-saas-template" target="_blank">full guide here</a>.</p>
        <br>
        <p>Let's get started!</p></p>
        <br>
        <hr>
        <h2>Prerequisites</h2>
        <p>Before using this template, make sure you have the following:</p>
        <ul>
          <li>A <a href="https://dashboard.stripe.com/login" target="_blank">Stripe account</a></li>
          <li>Basic knowledge of Anvil (a great place to start is with Anvil's <a href="https://anvil.works/learn/tutorials/feedback-form" target="_blank">Feedback form tutorial</a>)</li>
        </ul>
        <br>
        <hr>
        <h2>Configuring Stripe Integration</h2>
        <p>This template uses Stripe for payment processing and subscription management. To set up and use this template, follow these steps:</p>
        <ol>
          <li><a href="https://dashboard.stripe.com/login" target="_blank">Register for a Stripe account</a> and login</li>
          <li>Enter your <a href="https://support.stripe.com/questions/business-information-requirements-to-use-stripe?locale=en-GB" target="_blank">business details</a> to start capturing recurring revenue (or skip this step if you're only going to use <a href="https://stripe.com/docs/test-mode?locale=en-GB">Stripe's test mode</a>)</li>
          <li>Activate Stripe's <a href="https://stripe.com/docs/test-mode?locale=en-GB" target="_blank">test mode</a></li>
          <li>Copy your <a href="https://stripe.com/docs/keys" target="_blank">Stripe account's Secret key</a> and, in this app's <a href="https://anvil.works/docs/security/encrypting-secret-data" target="_blank">App Secrets</a>, set the value of "stripe_test_api_key" to your key</li>
          <img src="https://anvil-website-static.s3.eu-west-2.amazonaws.com/templates/saas-template/app-secrets-location.png" />
          <li>In the Anvil app editor, click <a href="https://anvil.works/docs/deployment-new-ide/quickstart" target="_blank">"Publish this app"</a> in the top right of the editor and take a copy of the URL - we'll use this in step 6</li>
          <li>In the Stripe dashboard, <a href="https://dashboard.stripe.com/test/products?active=true" target="_blank">navigate to the Product catalogue</a>, select the <a href="https://dashboard.stripe.com/test/pricing-tables" target="_blank">Pricing tables tab</a>, and create a <a href="https://stripe.com/docs/payments/checkout/pricing-table" target="_blank">pricing table</a>.</li>
            <ol type="a">
              <li>Create a <a href="https://stripe.com/docs/products-prices/how-products-and-prices-work#what-is-a-product" target="_blank">product</a> called "Personal"</li>
              <li>Add one <a href="https://stripe.com/docs/products-prices/how-products-and-prices-work#what-is-a-price" target="_blank">price</a> to the Personal product</li>
              <li>In the payment settings for each product you will find a "Confirmation page" section. In that section select "Don't show confirmation page" and enter the URL of this app that we copied in step 5.</li>
              <br>
                  <img src="https://anvil-website-static.s3.eu-west-2.amazonaws.com/templates/saas-template/pricing-table.png" />
                  <br><br>
            </ol>
          <li>Stripe's website should take you to your <a href="https://dashboard.stripe.com/test/pricing-tables" target="_blank">pricing table's page (if not, follow this link and select your pricing table)</a>. We need to add the details of this to our SaaS app.
            <figure style="display: table;">
              <img src="https://anvil-website-static.s3.eu-west-2.amazonaws.com/templates/saas-template/stripe-dashboard-pricing-table-code.png"/>
              <figcaption style="display: table-caption; caption-side: top; text-align: center; font-size: 0.9em;"><i>The <a href="https://dashboard.stripe.com/test/pricing-tables" target="_blank">pricing table page</a></i></figcaption>
            </figure>
            <ol type="a">
              <li>Copy the code for the pricing table.</li>
              <li>Open the StripePricing form in the Anvil editor and <a href="https://anvil.works/docs/ui/components/forms#HTML-Forms-&-Custom-HTML-Forms" target="_blank">edit the custom HTML</a></li>
              <li>And paste the code it into the StripePricing form's custom HTML.</li>
              <li>Lastly, add <code>anvil-name="stripe-pricing-table"</code> to the stripe-pricing-table tag. The final HTML should look like this:</li>
              <br><br>
              <figure style="display: table;">
                <img src="https://anvil-website-static.s3.eu-west-2.amazonaws.com/templates/saas-template/stripe-pricing-html.png" style="max-width: 90%;" />
                <figcaption style="display: table-caption; caption-side: top; text-align: center; font-size: 0.9em;"><i>Example of the finished StripePricing form's custom HTML</i></figcaption>
              </figure>
              <br><br>
              <li>You can switch to the <a href="https://anvil.works/docs/editor/form-editor#design-view">Design View</a> to see the Pricing Table.</li>
            </ol>
          </li>
          <li> We need Stripe to tell us when a new customer is created and when their subscription is updated, so we can update our Users table with the Stripe subscription details. We'll use webhooks to do this. <a href="https://stripe.com/docs/development/dashboard/register-webhook?locale=en-GB#add-a-webhook-endpoint" target="_blank">There is a guide to setting up webhooks in Stripe here</a> but let me give you brief instructions.
            <ol type="a">
              <li> <b>Customer Created</b>
                <ol type="i">
                  <li>Open the <a href="https://dashboard.stripe.com/test/webhooks" target="_blank">Webhooks page</a> in Stripe and click the "+ Add endpoint" button.</li>
                  <li>Set the endpoint URL to your published app's URL with "/_/api/stripe/stripe_customer_created" on the end - i.e. "https://my-saas.anvil.app/_/api/stripe/stripe_customer_created".
                  <img src="https://anvil-website-static.s3.eu-west-2.amazonaws.com/templates/saas-template/endpoint-url.png" style="max-width: 40%;"/>
                  </li>
                  <li>Then click "+ select events" and select "customer.created" under events to listen for. </br>
                  <img src="https://anvil-website-static.s3.eu-west-2.amazonaws.com/templates/saas-template/searching-events.png" style="max-width: 40%;"/>
                  </li>
                  <li>From now on, this will call the `stripe_customer_created` function in your Anvil app's StripeFunctions module when a customer is created.</li>
                  <br>
                  <img src="https://anvil-website-static.s3.eu-west-2.amazonaws.com/templates/saas-template/webhook-setup.png" />
                  <br><br>
                </ol>
              </li>
              <li> <b>Subscription Updated</b>
                <ol type="i">
                  <li>Add another endpoint in Stripe.</li>
                  <li>Set the endpoint URL to your published app's URL with "/_/api/stripe/stripe_subscription_updated" on the end i.e. "https://my-saas.anvil.app/_/api/stripe/stripe_subscription_updated"</li>
                  <li>Then select "customer.subscription.updated" under events to listen for.</li>
                  <li>From now on, this will call the `stripe_subscription_updated` function in the StripeFunctions module every time a customer is created.</li>
                </ol>
              </li>
              <br>
              <figure style="display: table;">
                <img src="https://anvil-website-static.s3.eu-west-2.amazonaws.com/templates/saas-template/finished-webhooks.png" />
                <figcaption style="display: table-caption; caption-side: top; text-align: center; font-size: 0.9em;"><i>Your <a href="https://dashboard.stripe.com/test/webhooks" target="_blank">Stripe webhooks </a> should look like this</i></figcaption>
              </figure>
              <br><br>
            </ol>
          <li>Let's quickly set up a way for users to cancel their subscription.
            <ol type="a">
              <li>Go the Stripe dashboard and set up a <a href="https://dashboard.stripe.com/settings/billing/portal" target="_blank">customer portal</a>
              <figure style="display: table;">
                <img src="https://anvil-website-static.s3.eu-west-2.amazonaws.com/templates/saas-template/customer-portal-location.png" />
                <figcaption style="display: table-caption; caption-side: top; text-align: center; font-size: 0.9em;"><i>Searching for the customer portal.</i></figcaption>
              </figure>
              </li>
              <li>Activate the test link and copy it</li>
              <li>Open the SaaS app's AccountManagement form and point the "manage_subscription_link" component's URL to the copied link
              <figure style="display: table;">
                <img src="https://anvil-website-static.s3.eu-west-2.amazonaws.com/templates/saas-template/manage-subscription-button.png" />
                <figcaption style="display: table-caption; caption-side: top; text-align: center; font-size: 0.9em;"><i>The URL we need to update.</i></figcaption>
              </figure>
              </li>
            </ol>
          <li>Lastly, in the Anvil editor, switch the <a href="https://anvil.works/docs/client/components/forms#the-startup-form-or-module" target="_blank">startup form</a> from "APP_README" to "LoginPage" </li>
        </ol>
        <p>With these steps completed, your Stripe integration is ready for testing.</p>
        <br>
        <hr>
        <h2>Testing this app</h2>
        <p>To test the app, set the Login form to be the <a href="https://anvil.works/docs/client/components/forms#the-startup-form-or-module" target="_blank">"startup form"</a>. Then <a href="https://anvil.works/docs/editor#the-anvil-editor" target="_blank">run the app</a> and follow along with the in-app instruction notifications.</p>
        ## Testing The App

      The template has a number of [Notifications](https://anvil.works/docs/client/alerts-and-notifications#notifications) which will guide you through testing the app as a user. This will both test the integration we've set up and let you experience what the app is like as a user. [Run the app](https://anvil.works/docs/editor#the-anvil-editor) and follow along with the in-app instruction notifications.

      {{<figure src="https://anvil-website-static.s3.eu-west-2.amazonaws.com/templates/saas-template/notification-example.png" narrow="true" width="800px" caption="Example of the testing notifications guide">}}
        <br>
        <hr>
        <h2>Making this app your own</h2>
        <p>Now that your Stripe integration is set up and you've experienced the app from a user's perspective, it's time to make this app your own.</p>
        <p>Let's start by removing all of the in-app instruction notifications:</p>
        <ol>
          <li>Search (<i>ctrl+shift+F</i>) for "# TEMPLATE EXPLANATION ONLY" comments and delete all the lines mentioned in the comment</li>
          <li></li>
        </ol>
      </body>
  type: HtmlTemplate
is_package: true
